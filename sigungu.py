# -*- coding: utf-8 -*-
# create_mapping_csv.py
import re
import pandas as pd

# 여기에 얻으신 전체 시군구 코드 데이터 문자열을 붙여넣으세요.
# 예시: "11110 | 종로구11 | 서울시 | 11140 | 중구11 | 서울시 | ..."
data_string = """
11110 | 종로구11 | 서울시 | 11140 | 중구11 | 서울시 | 11170 | 용산구11 | 서울시 | 11200 | 성동구11 | 서울시 | 11215 | 광진구11 | 서울시 | 11230 | 동대문구11 | 서울시 | 11260 | 중랑구11 | 서울시 | 45130 | 전주시 덕진구45 | 전북도 | 45140 | 군산시45 | 전북도 | 45180 | 익산시45 | 전북도 | 45190 | 정읍시45 | 전북도 | 45210 | 남원시45 | 전북도 | 45710 | 김제시45 | 전북도 | 45720 | 완주군45 | 전북도 | 45730 | 진안군45 | 전북도 | 45740 | 장수군45 | 전북도 | 45750 | 임실군45 | 전북도 | 45770 | 순창군45 | 전북도 | 45790 | 고창군45 | 전북도 | 45800 | 부안군46 | 전남도 | 46110 | 목포시46 | 전남도 | 46130 | 여수시46 | 전남도 | 46150 | 순천시46 | 전남도 | 46170 | 나주시46 | 전남도 | 46230 | 광양시46 | 전남도 | 46710 | 담양군46 | 전남도 | 46720 | 곡성군46 | 전남도 | 46730 | 구례군46 | 전남도 | 46770 | 고흥군46 | 전남도 | 46780 | 보성군46 | 전남도 | 46790 | 화순군46 | 전남도 | 46800 | 장흥군46 | 전남도 | 46810 | 강진군46 | 전남도 | 46820 | 해남군46 | 전남도 | 46830 | 영암군46
""" # 여기에 전체 데이터를 붙여넣으세요.

# 정규 표현식 패턴 정의 (시군구명과 코드만 추출)
# 패턴: (\d+)\s*\|\s*([가-힣\s]+?)(\d+)\s*\|\s*([가-힣]+)\s*\|?
# 그룹1: 시군구코드 (\d+)
# 그룹2: 시군구명 ([가-힣\s]+?)
# 그룹3: 시군구명 뒤 숫자 (\d+)
# 그룹4: 시도명 ([가-힣]+)
pattern = re.compile(r'(\d+)\s*\|\s*([가-힣\s]+?)(\d+)\s*\|\s*([가-힣]+)\s*\|?')

parsed_data = []

# 정규 표현식으로 전체 문자열에서 모든 매치 찾기
matches = pattern.findall(data_string)

for match in matches:
    sigungu_code = match[0].strip()    # 예: "11110"
    sigungu_name_raw = match[1].strip() # 예: "종로구"
    # 시군구명 뒤에 붙어있던 시도 코드 숫자 제거 (필요하다면)
    sigungu_name = sigungu_name_raw

    # 시군구명과 시군구 코드만 리스트에 추가
    parsed_data.append([sigungu_name, sigungu_code])

# DataFrame 생성 (컬럼명 변경)
df_codes = pd.DataFrame(parsed_data, columns=['시군구', 'SIG_CD'])

# CSV 파일로 저장
output_csv_path = 'sigungu_codes_only.csv' # 파일명 변경
df_codes.to_csv(output_csv_path, index=False, encoding='utf-8')

print(f"시군구 코드 매핑 파일 '{output_csv_path}' 생성이 완료되었습니다.")
print("생성된 파일의 처음 5행:")
print(df_codes.head())
# -*- coding: utf-8 -*-
# create_mapping_csv.py
import re
import pandas as pd

# 여기에 얻으신 전체 시군구 코드 데이터 문자열을 붙여넣으세요.
# 예시: "11110 | 종로구11 | 서울시 | 11140 | 중구11 | 서울시 | ..."
data_string = """
11 | 서울시 | 11110 | 종로구11 | 서울시 | 11140 | 중구11 | 서울시 | 11170 | 용산구11 | 서울시 | 11200 | 성동구11 | 서울시 | 11215 | 광진구11 | 서울시 | 11230 | 동대문구11 | 서울시 | 11260 | 중랑구11 | 서울시 | 11290 | 성북구11 | 서울시 | 11305 | 강북구11 | 서울시 | 11320 | 도봉구11 | 서울시 | 11350 | 노원구11 | 서울시 | 11380 | 은평구11 | 서울시 | 11410 | 서대문구11 | 서울시 | 11440 | 마포구11 | 서울시 | 11470 | 양천구11 | 서울시 | 11500 | 강서구11 | 서울시 | 11530 | 구로구11 | 서울시 | 11545 | 금천구11 | 서울시 | 11560 | 영등포구11 | 서울시 | 11590 | 동작구11 | 서울시 | 11620 | 관악구11 | 서울시 | 11650 | 서초구11 | 서울시 | 11680 | 강남구11 | 서울시 | 11710 | 송파구11 | 서울시 | 11740 | 강동구26 | 부산시 | 26110 | 중구26 | 부산시 | 26140 | 서구26 | 부산시 | 26170 | 동구26 | 부산시 | 26200 | 영도구26 | 부산시 | 26230 | 부산진구26 | 부산시 | 26260 | 동래구26 | 부산시 | 26290 | 남구26 | 부산시 | 26320 | 북구26 | 부산시 | 26350 | 해운대구26 | 부산시 | 26380 | 사하구26 | 부산시 | 26410 | 금정구26 | 부산시 | 26440 | 강서구26 | 부산시 | 26470 | 연제구26 | 부산시 | 26500 | 수영구26 | 부산시 | 26530 | 사상구26 | 부산시 | 26710 | 기장군27 | 대구시 | 27110 | 중구27 | 대구시 | 27140 | 동구27 | 대구시 | 27170 | 서구27 | 대구시 | 27200 | 남구27 | 대구시 | 27230 | 북구27 | 대구시 | 27290 | 수성구27 | 대구시 | 27290 | 달서구27 | 대구시 | 27710 | 달성군28 | 인천시 | 28110 | 중구28 | 인천시 | 28140 | 동구28 | 인천시 | 28170 | 남구28 | 인천시 | 28185 | 연수구28 | 인천시 | 28200 | 남동구28 | 인천시 | 28237 | 부평구28 | 인천시 | 28245 | 계양구28 | 인천시 | 28260 | 서구28 | 인천시 | 28710 | 강화군28 | 인천시 | 28720 | 옹진군29 | 광주시 | 29110 | 동구29 | 광주시 | 29140 | 서구29 | 광주시 | 29155 | 남구29 | 광주시 | 29170 | 북구29 | 광주시 | 29200 | 광산구30 | 대전시 | 30110 | 동구30 | 대전시 | 30140 | 중구30 | 대전시 | 30170 | 서구30 | 대전시 | 30200 | 유성구30 | 대전시 | 30230 | 대덕구31 | 울산시 | 31110 | 중구31 | 울산시 | 31140 | 남구31 | 울산시 | 31170 | 동구31 | 울산시 | 31200 | 북구31 | 울산시 | 31710 | 울주군41 | 경기도 | 41110 | 수원시41 | 경기도 | 41111 | 수원시 장안구41 | 경기도 | 41113 | 수원시 권선구41 | 경기도 | 41115 | 수원시 팔달구41 | 경기도 | 41117 | 수원시 영통구41 | 경기도 | 41130 | 성남시41 | 경기도 | 41131 | 성남시 수정구41 | 경기도 | 41133 | 성남시 중원구41 | 경기도 | 41135 | 성남시 분당구41 | 경기도 | 41150 | 의정부시41 | 경기도 | 41170 | 안양시41 | 경기도 | 41171 | 안양시 만안구41 | 경기도 | 41173 | 안양시 동안구41 | 경기도 | 41190 | 부천시41 | 경기도 | 41195 | 부천시 원미구41 | 경기도 | 41197 | 부천시 소사구41 | 경기도 | 41199 | 부천시 오정구41 | 경기도 | 41210 | 광명시41 | 경기도 | 41220 | 평택시41 | 경기도 | 41250 | 동두천시41 | 경기도 | 41270 | 안산시41 | 경기도 | 41271 | 안산시 상록구41 | 경기도 | 41273 | 안산시 단원구41 | 경기도 | 41280 | 고양시41 | 경기도 | 41281 | 고양시 덕양구41 | 경기도 | 41285 | 고양시 일산동구41 | 경기도 | 41287 | 고양시 일산서구41 | 경기도 | 41290 | 과천시41 | 경기도 | 41310 | 구리시41 | 경기도 | 41360 | 남양주시41 | 경기도 | 41370 | 오산시41 | 경기도 | 41390 | 시흥시41 | 경기도 | 41410 | 군포시41 | 경기도 | 41430 | 의왕시41 | 경기도 | 41450 | 하남시41 | 경기도 | 41460 | 용인시41 | 경기도 | 41461 | 용인시 처인구41 | 경기도 | 41463 | 용인시 기흥구41 | 경기도 | 41465 | 용인시 수지구41 | 경기도 | 41480 | 파주시41 | 경기도 | 41500 | 이천시41 | 경기도 | 41550 | 안성시41 | 경기도 | 41570 | 김포시41 | 경기도 | 41590 | 화성시41 | 경기도 | 41610 | 광주시41 | 경기도 | 41630 | 양주시41 | 경기도 | 41650 | 포천시41 | 경기도 | 41730 | 여주군41 | 경기도 | 41800 | 연천군41 | 경기도 | 41820 | 가평군41 | 경기도 | 41830 | 양평군42 | 강원도 | 42110 | 춘천시42 | 강원도 | 42130 | 원주시42 | 강원도 | 42150 | 강릉시42 | 강원도 | 42170 | 동해시42 | 강원도 | 42190 | 태백시42 | 강원도 | 42210 | 속초시42 | 강원도 | 42230 | 삼척시42 | 강원도 | 42720 | 홍천군42 | 강원도 | 42730 | 횡성군42 | 강원도 | 42750 | 영월군42 | 강원도 | 42760 | 평창군42 | 강원도 | 42770 | 정선군42 | 강원도 | 42780 | 철원군42 | 강원도 | 42790 | 화천군42 | 강원도 | 42800 | 양구군42 | 강원도 | 42810 | 인제군42 | 강원도 | 42820 | 고성군42 | 강원도 | 42830 | 양양군43 | 충북도 | 43110 | 청주시43 | 충북도 | 43111 | 청주시 상당구43 | 충북도 | 43113 | 청주시 흥덕구43 | 충북도 | 43130 | 충주시43 | 충북도 | 43150 | 제천시43 | 충북도 | 43710 | 청원군43 | 충북도 | 43720 | 보은군43 | 충북도 | 43730 | 옥천군43 | 충북도 | 43740 | 영동군43 | 충북도 | 43745 | 증평군43 | 충북도 | 43750 | 진천군43 | 충북도 | 43760 | 괴산군43 | 충북도 | 43770 | 음성군43 | 충북도 | 43800 | 단양군44 | 충남도 | 44130 | 천안시44 | 충남도 | 44131 | 천안시 동남구44 | 충남도 | 44133 | 천안시 서북구44 | 충남도 | 44150 | 공주시44 | 충남도 | 44180 | 보령시44 | 충남도 | 44200 | 아산시44 | 충남도 | 44210 | 서산시44 | 충남도 | 44230 | 논산시44 | 충남도 | 44250 | 계룡시44 | 충남도 | 44710 | 금산군44 | 충남도 | 44730 | 연기군44 | 충남도 | 44760 | 부여군44 | 충남도 | 44770 | 서천군44 | 충남도 | 44790 | 청양군44 | 충남도 | 44800 | 홍성군44 | 충남도 | 44810 | 예산군44 | 충남도 | 44825 | 태안군44 | 충남도 | 44830 | 당진군45 | 전북도 | 45110 | 전주시45 | 전북도 | 45111 | 전주시 완산구45 | 전북도 | 45113 | 전주시 덕진구45 | 전북도 | 45130 | 군산시45 | 전북도 | 45140 | 익산시45 | 전북도 | 45180 | 정읍시45 | 전북도 | 45190 | 남원시45 | 전북도 | 45210 | 김제시45 | 전북도 | 45710 | 완주군45 | 전북도 | 45720 | 진안군45 | 전북도 | 45730 | 무주군45 | 전북도 | 45740 | 장수군45 | 전북도 | 45750 | 임실군45 | 전북도 | 45770 | 순창군45 | 전북도 | 45790 | 고창군45 | 전북도 | 45800 | 부안군46 | 전남도 | 46110 | 목포시46 | 전남도 | 46130 | 여수시46 | 전남도 | 46150 | 순천시46 | 전남도 | 46170 | 나주시46 | 전남도 | 46230 | 광양시46 | 전남도 | 46710 | 담양군46 | 전남도 | 46720 | 곡성군46 | 전남도 | 46730 | 구례군46 | 전남도 | 46770 | 고흥군46 | 전남도 | 46780 | 보성군46 | 전남도 | 46790 | 화순군46 | 전남도 | 46800 | 장흥군46 | 전남도 | 46810 | 강진군46 | 전남도 | 46820 | 해남군46 | 전남도 | 46830 | 영암군46 | 전남도 | 46840 | 무안군46 | 전남도 | 46860 | 함평군46 | 전남도 | 46870 | 영광군46 | 전남도 | 46880 | 장성군46 | 전남도 | 46890 | 완료도군46 | 전남도 | 46900 | 진도군46 | 전남도 | 46910 | 신안군47 | 경북도 | 47110 | 포항시47 | 경북도 | 47111 | 포항시 남구47 | 경북도 | 47113 | 포항시 북구47 | 경북도 | 47130 | 경주시47 | 경북도 | 47150 | 김천시47 | 경북도 | 47170 | 안동시47 | 경북도 | 47190 | 구미시47 | 경북도 | 47210 | 영주시47 | 경북도 | 47230 | 영천시47 | 경북도 | 47250 | 상주시47 | 경북도 | 47280 | 문경시47 | 경북도 | 47290 | 경산시47 | 경북도 | 47720 | 군위군47 | 경북도 | 47730 | 의성군47 | 경북도 | 47750 | 청송군47 | 경북도 | 47760 | 영양군47 | 경북도 | 47770 | 영덕군47 | 경북도 | 47820 | 청도군47 | 경북도 | 47830 | 고령군47 | 경북도 | 47840 | 성주군47 | 경북도 | 47850 | 칠곡군47 | 경북도 | 47900 | 예천군47 | 경북도 | 47920 | 봉화군47 | 경북도 | 47930 | 울진군47 | 경북도 | 47940 | 울릉군48 | 경남도 | 48120 | 창원시48 | 경남도 | 48125 | 창원시 마산합포구48 | 경남도 | 48127 | 창원시 마산회원구48 | 경남도 | 48123 | 창원시 성산구48 | 경남도 | 48121 | 창원시 의창구48 | 경남도 | 48129 | 창원시 진해구48 | 경남도 | 48170 | 진주시48 | 경남도 | 48220 | 통영시48 | 경남도 | 48240 | 사천시48 | 경남도 | 48250 | 김해시48 | 경남도 | 48270 | 밀양시48 | 경남도 | 48310 | 거제시48 | 경남도 | 48330 | 양산시48 | 경남도 | 48720 | 의령군48 | 경남도 | 48730 | 함안군48 | 경남도 | 48740 | 창녕군48 | 경남도 | 48820 | 고성군48 | 경남도 | 48840 | 남해군48 | 경남도 | 48850 | 하동군48 | 경남도 | 48860 | 산청군48 | 경남도 | 48870 | 함양군48 | 경남도 | 48880 | 거창군48 | 경남도 | 48890 | 합천군50 | 제주도 | 50110 | 제주시50 | 제주도 | 50130 | 서귀포시
""" # 여기에 전체 데이터를 붙여넣으세요.

# 정규 표현식 패턴 정의 (시군구명과 코드만 추출)
# 패턴: (\d+)\s*\|\s*([가-힣\s]+?)(\d+)\s*\|\s*([가-힣]+)\s*\|?
# 그룹1: 시군구코드 (\d+)
# 그룹2: 시군구명 ([가-힣\s]+?)
# 그룹3: 시군구명 뒤 숫자 (\d+)
# 그룹4: 시도명 ([가-힣]+)
pattern = re.compile(r'(\d+)\s*\|\s*([가-힣\s]+?)(\d+)\s*\|\s*([가-힣]+)\s*\|?')

parsed_data = []

# 정규 표현식으로 전체 문자열에서 모든 매치 찾기
matches = pattern.findall(data_string)

for match in matches:
    sigungu_code = match[0].strip()    # 예: "11110"
    sigungu_name_raw = match[1].strip() # 예: "종로구"
    # 시군구명 뒤에 붙어있던 시도 코드 숫자 제거 (필요하다면)
    sigungu_name = sigungu_name_raw

    # 시군구명과 시군구 코드만 리스트에 추가
    parsed_data.append([sigungu_name, sigungu_code])

# DataFrame 생성 (컬럼명 변경)
df_codes = pd.DataFrame(parsed_data, columns=['시군구', 'SIG_CD'])

# CSV 파일로 저장
output_csv_path = 'sigungu_codes_only.csv' # 파일명 변경
df_codes.to_csv(output_csv_path, index=False, encoding='utf-8')

print(f"시군구 코드 매핑 파일 '{output_csv_path}' 생성이 완료되었습니다.")
print("생성된 파일의 처음 5행:")
print(df_codes.head())
